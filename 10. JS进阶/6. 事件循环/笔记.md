# 事件循环

异步：某些函数不会立即执行，需要等到某个时机成熟后才会执行，该函数叫做异步函数。

```js
setTimeout(function A() {
            console.log("异步代码")
        }, 0)
// setTimeout这个函数是马上执行结束，然后销毁的，只是告诉浏览器的定时器线程，让它一秒钟后执行函数，函数的定义是立即完成的
```

浏览器的线程：

1. JS执行引擎：负责执行JS代码
2. 渲染线程：负责渲染页面
3. 计时器线程：负责计时
4. 事件监听线程：负责监听事件
5. http网络线程：负责网络通信

事件队列：一块内存空间，用于存放执行时机到达的异步函数。当JS引擎空闲（执行栈没有可执行的上下文），它会从事件队列中拿出第一个函数执行。

事件循环：event loop，是指函数在执行栈、宿主线程、事件队列中的循环移动。

## js 加载时间线（可以理解成浏览器加载时间线）
    > js 加载时间线：依据 js 出生的那一刻起，记录了一系列浏览器按照顺序做的事（就
      是一个执行顺序）
      js 时间线步骤（创建 document 对象==>文档解析完==>文档解析完加载完执行完）
      1、创建 Document 对象，开始解析 web 页面。解析 HTML 元素和他们的文本内容
      后添加 Element 对象和 Text 节点到文档中。这个阶段 document.readyState =
      'loading'。
      2、遇到 link 外部 css，创建线程，进行异步加载，并继续解析文档。
      3、遇到 script 外部 js，并且没有设置 async、defer，浏览器同步加载，并阻塞，等
      待 js 加载完成并执行该脚本，然后继续解析文档。
      4、遇到 script 外部 js，并且设置有 async、defer，浏览器创建线程异步加载，并继
      续解析文档。
      对于 async 属性的脚本，脚本加载完成后立即执行。（异步禁止使用 document.write()，
      因为当你整个文档解析到差不多，再调用 document.write()，会把之前所有的文档流
      都清空，用它里面的文档代替）
      5、遇到 img 等（带有 src），先正常解析 dom 结构，然后浏览器异步加载 src，并继
      续解析文档。 看到标签直接生产 dom 树，不用等着 img 加载完 scr。
      6、当文档解析完成（domTree 建立完毕，不是加载完毕），document.readyState =
      'interactive'。
      7、文档解析完成后，所有设置有 defer 的脚本会按照顺序执行。（注意与 async 的不
      同,但同样禁止使用 document.write()）;
      8、document 对象触发 DOMContentLoaded 事件，这也标志着程序执行从同步脚本
      执行阶段，转化为事件驱动阶段。
      9、当所有 async 的脚本加载完成并执行后、img 等加载完成后（页面所有的都执行
      加载完之后），document.readyState = 'complete'，window 对象触发 load 事件。
      10、从此，以异步响应方式处理用户输入、网络事件等。